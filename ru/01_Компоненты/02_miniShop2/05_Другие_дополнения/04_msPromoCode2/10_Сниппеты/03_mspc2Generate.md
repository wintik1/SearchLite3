Генерирует промо-код через N секунд пребывания на странице и [выводит всплывашку][1] для юзера.
Обычно вызывается на каждой странице сайта, чтобы точнее отслеживать время пребывания.

<img src="https://file.modx.pro/files/1/4/5/14526526bf347d2880e3c55057359051.png" alt="" width="280">


> С версии 1.1.12 можно задать время жизни, а также указать дополнительные настройки из конфига.
> Также, для промо-кода с указанным временем жизни (менее 24 часов) в окошке появляется обратный отсчёт.

![Обратный отсчёт для промо-кода с указанным lifetime](https://file.modx.pro/files/b/3/3/b33b86adc5f34c2af1e60b9de15ef730.gif)
![Обратный отсчёт для промо-кода с указанным lifetime](https://file.modx.pro/files/1/6/c/16c94437fac6d143cf8f2cefc788285e.gif)


### Параметры

#### Основные

Название					| По умолчанию									| Описание
----------------------------|-----------------------------------------------|------------------------------------------------------------------------------------------
**format**		            | `[a-zA-Z0-9]{12}`        			            | Формат промо-кода с возможностью использовать regex-like синтаксис.
**seconds**	                | `90`        			                        | Кол-во секунд для генерации. Отсчёт происходит только на страницах, где вызывается сниппет .
**tpl**		         	    | `tpl.msPromoCode2.generate`        			| Шаблон уведомления.


#### Настройки для промо-кода

Название					| По умолчанию									| Описание
----------------------------|-----------------------------------------------|------------------------------------------------------------------------------------------
**list**		            | `generate`        			                | Поле "Список" для промо-кода.
**count**		            | `1`        			                        | Сколько раз можно применить генерируемый промо-код.
**discount**	            | `10%`        			                        | Размер скидки для генерируемого промо-кода.
**description**	            |           			                        | Описание для генерируемого промо-кода.
**showinfo**	            | `1`          			                        | Отображать "жёлтые" предупреждения при применении промо-кода.
**oneunit**	                | `0`          			                        | Применять скидку только к одной единице товара.
**onlycart**	            | `0`          			                        | Отображать цену со скидкой только в корзине.
**unsetifnull**	            | `0`          			                        | Отменять, если в корзине нет товаров, соответствующих этому промо-коду.
**unsetifnull_msg**	        |           			                        | Текст при отмене. Работает только со включённым `unsetifnull`
**oldprice**	            | `0`          			                        | Применять только к товарам без старой цены.
**lifetime**	            |           			                        | Время действия промо-кода. В секундах. Использовать либо этот параметр, либо `startedon` + `stoppedon`.
**startedon**	            |           			                        | Начало действия промо-кода, timestamp. Использовать либо этот параметр + `stoppedon`, либо `lifetime`.
**stoppedon**	            |           			                        | Конец действия промо-кода, timestamp. Использовать либо этот параметр + `startedon`, либо `lifetime`.


### Примеры

####  25% скидки спустя 20 секунд на сайте

Генерирует промо-код на 25% скидки спустя 20 секунд пребывания на сайте 
и выводит окошко с этим промо-кодом юзеру.


```html
{'!mspc2Generate' | snippet : [
    'discount' => '25%',
    'seconds' => 20,
]}
```


#### С префиксом формата hello12345

Генерирует промо-код с префиксом формата hello12345 через 90 секунд (по-умолчанию) пребывания на сайте 
и выводит окошко с этим промо-кодом юзеру.


```html
{'!mspc2Generate' | snippet : [
    'format' => 'hello[0-9]{5}',
]}
```


#### С обратным отсчётом

Генерирует промо-код на 10% спустя 20 секунд пребывания на сайте, 
а также задаёт время жизни для промо-кода в 20 минут,
и выводит окошко с промо-кодом и обратным отсчётом юзеру.

Также у промо-кода задано описание и установлена галка `Отображать цену со скидкой только в корзине`.


```html
{'!mspc2Generate' | snippet : [
    'discount' => '10%',
    'seconds' => 20,
    'description' => 'Сгенерированный промо-код',
    'onlycart' => true,
    'lifetime' => 60 * 20,
]}
```


[1]: https://file.modx.pro/files/1/4/5/14526526bf347d2880e3c55057359051.png
